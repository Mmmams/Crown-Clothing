{"ast":null,"code":"import _objectSpread from\"C:/Users/Siarhei.Mamykin/Desktop/Crown-Clothing-/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/Siarhei.Mamykin/Desktop/Crown-Clothing-/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,call,all,take}from\"redux-saga/effects\";import userActionTypes from\"./user.types\";import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from\"../../firebase/firebase.utils\";import{signInFailure,signInSuccess,signOutSuccess,signOutFailure,signUpFailure,signUpSuccess}from\"./user.actions\";export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return auth.signOut();case 3:_context.next=5;return put(signOutSuccess());case 5:_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);_context.next=11;return put(signOutFailure());case 11:case\"end\":return _context.stop();}}},_marked,null,[[0,7]]);}export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return takeLatest(userActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context2.stop();}}},_marked2);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return getCurrentUser();case 3:userAuth=_context3.sent;if(userAuth){_context3.next=6;break;}return _context3.abrupt(\"return\");case 6:_context3.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);_context3.next=14;return put(signInFailure(_context3.t0));case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[0,10]]);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(userActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context5.sent;_context5.next=6;return userRef.get();case 6:userSnapshot=_context5.sent;_context5.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context5.next=15;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](0);_context5.next=15;return put(signInFailure(_context5.t0));case 15:case\"end\":return _context5.stop();}}},_marked5,null,[[0,11]]);}export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context6.sent;user=_yield$auth$signInWit.user;_context6.next=7;return getSnapshotFromUserAuth(user);case 7:_context6.next=13;break;case 9:_context6.prev=9;_context6.t0=_context6[\"catch\"](0);_context6.next=13;return put(signInFailure(_context6.t0));case 13:case\"end\":return _context6.stop();}}},_marked6,null,[[0,9]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(userActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function signInWithEmail(_ref){var _ref$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password;_context8.prev=1;_context8.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context8.sent;user=_yield$auth$signInWit2.user;_context8.next=8;return getSnapshotFromUserAuth(user);case 8:_context8.next=14;break;case 10:_context8.prev=10;_context8.t0=_context8[\"catch\"](1);_context8.next=14;return put(signInFailure(_context8.t0));case 14:case\"end\":return _context8.stop();}}},_marked8,null,[[1,10]]);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(userActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function signUp(_ref2){var _ref2$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password,displayName=_ref2$payload.displayName;_context10.prev=1;_context10.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context10.sent;user=_yield$auth$createUse.user;_context10.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context10.next=14;break;case 10:_context10.prev=10;_context10.t0=_context10[\"catch\"](1);_context10.next=14;return put(signUpFailure(_context10.t0));case 14:case\"end\":return _context10.stop();}}},_marked10,null,[[1,10]]);}export function signInAfterSignUp(_ref3){var _ref3$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_ref3$payload=_ref3.payload,user=_ref3$payload.user,additionalData=_ref3$payload.additionalData;_context11.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context11.stop();}}},_marked11);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(userActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(userActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onSignOutStart),call(onSignUpSuccess),call(onSignUpStart)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["C:/Users/Siarhei.Mamykin/Desktop/Crown-Clothing-/client/src/redux/user/user-sagas.js"],"names":["signOut","onSignOutStart","isUserAuthenticated","onCheckUserSession","getSnapshotFromUserAuth","signInWithGoogle","onGoogleSignInStart","signInWithEmail","onEmailSignInStart","signUp","signInAfterSignUp","onSignUpSuccess","onSignUpStart","userSagas","takeLatest","put","call","all","take","userActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","signInFailure","signInSuccess","signOutSuccess","signOutFailure","signUpFailure","signUpSuccess","SIGN_OUT_START","userAuth","CHECK_USER_SESSION","additionalData","userRef","get","userSnapshot","id","data","signInWithPopup","user","GOOGLE_SIGN_IN_START","payload","email","password","signInWithEmailAndPassword","EMAIL_SIGN_IN_START","displayName","createUserWithEmailAndPassword","SIGN_UP_SUCCESS","SIGN_UP_START"],"mappings":"oYAkBiBA,O,iDASAC,c,iDAIAC,mB,iDAUAC,kB,iDAIAC,uB,iDAeAC,gB,iDASAC,mB,iDAIAC,e,iDASAC,kB,kDAIAC,M,kDASAC,iB,kDAIAC,e,kDAIAC,a,kDAIAC,S,EA3GjB,OAASC,UAAT,CAAqBC,GAArB,CAA0BC,IAA1B,CAAgCC,GAAhC,CAAqCC,IAArC,KAAiD,oBAAjD,CACA,MAAOC,CAAAA,eAAP,KAA4B,cAA5B,CACA,OACEC,IADF,CAEEC,cAFF,CAGEC,yBAHF,CAIEC,cAJF,KAKO,+BALP,CAOA,OACEC,aADF,CAEEC,aAFF,CAGEC,cAHF,CAIEC,cAJF,CAKEC,aALF,CAMEC,aANF,KAOO,gBAPP,CASA,MAAO,SAAU7B,CAAAA,OAAV,mJAEH,MAAMoB,CAAAA,IAAI,CAACpB,OAAL,EAAN,CAFG,uBAGH,MAAMe,CAAAA,GAAG,CAACW,cAAc,EAAf,CAAT,CAHG,uGAKH,MAAMX,CAAAA,GAAG,CAACY,cAAc,EAAf,CAAT,CALG,oEASP,MAAO,SAAU1B,CAAAA,cAAV,8IACL,MAAMa,CAAAA,UAAU,CAACK,eAAe,CAACW,cAAjB,CAAiC9B,OAAjC,CAAhB,CADK,wDAIP,MAAO,SAAUE,CAAAA,mBAAV,iLAEc,MAAMqB,CAAAA,cAAc,EAApB,CAFd,OAEGQ,QAFH,mBAGEA,QAHF,oFAIH,MAAM3B,CAAAA,uBAAuB,CAAC2B,QAAD,CAA7B,CAJG,8GAMH,MAAMhB,CAAAA,GAAG,CAACS,aAAa,cAAd,CAAT,CANG,uEAUP,MAAO,SAAUrB,CAAAA,kBAAV,kJACL,MAAMW,CAAAA,UAAU,CAACK,eAAe,CAACa,kBAAjB,CAAqC9B,mBAArC,CAAhB,CADK,wDAIP,MAAO,SAAUE,CAAAA,uBAAV,CAAkC2B,QAAlC,CAA4CE,cAA5C,gMAEa,MAAMjB,CAAAA,IAAI,CACxBM,yBADwB,CAExBS,QAFwB,CAGxBE,cAHwB,CAAV,CAFb,OAEGC,OAFH,iCAOkB,MAAMA,CAAAA,OAAO,CAACC,GAAR,EAAN,CAPlB,OAOGC,YAPH,iCASH,MAAMrB,CAAAA,GAAG,CAACU,aAAa,gBAAGY,EAAE,CAAED,YAAY,CAACC,EAApB,EAA2BD,YAAY,CAACE,IAAb,EAA3B,EAAd,CAAT,CATG,8GAWH,MAAMvB,CAAAA,GAAG,CAACS,aAAa,cAAd,CAAT,CAXG,uEAeP,MAAO,SAAUnB,CAAAA,gBAAV,gMAEc,MAAMe,CAAAA,IAAI,CAACmB,eAAL,CAAqBlB,cAArB,CAAN,CAFd,4CAEKmB,IAFL,uBAEKA,IAFL,kBAGH,MAAMpC,CAAAA,uBAAuB,CAACoC,IAAD,CAA7B,CAHG,4GAKH,MAAMzB,CAAAA,GAAG,CAACS,aAAa,cAAd,CAAT,CALG,sEASP,MAAO,SAAUlB,CAAAA,mBAAV,mJACL,MAAMQ,CAAAA,UAAU,CAACK,eAAe,CAACsB,oBAAjB,CAAuCpC,gBAAvC,CAAhB,CADK,wDAIP,MAAO,SAAUE,CAAAA,eAAV,gNAA4BmC,OAA5B,CAAuCC,KAAvC,cAAuCA,KAAvC,CAA8CC,QAA9C,cAA8CA,QAA9C,mCAEc,MAAMxB,CAAAA,IAAI,CAACyB,0BAAL,CAAgCF,KAAhC,CAAuCC,QAAvC,CAAN,CAFd,6CAEKJ,IAFL,wBAEKA,IAFL,kBAGH,MAAMpC,CAAAA,uBAAuB,CAACoC,IAAD,CAA7B,CAHG,8GAKH,MAAMzB,CAAAA,GAAG,CAACS,aAAa,cAAd,CAAT,CALG,uEASP,MAAO,SAAUhB,CAAAA,kBAAV,kJACL,MAAMM,CAAAA,UAAU,CAACK,eAAe,CAAC2B,mBAAjB,CAAsCvC,eAAtC,CAAhB,CADK,wDAIP,MAAO,SAAUE,CAAAA,MAAV,yNAAmBiC,OAAnB,CAA8BC,KAA9B,eAA8BA,KAA9B,CAAqCC,QAArC,eAAqCA,QAArC,CAA+CG,WAA/C,eAA+CA,WAA/C,qCAEc,MAAM3B,CAAAA,IAAI,CAAC4B,8BAAL,CAAoCL,KAApC,CAA2CC,QAA3C,CAAN,CAFd,6CAEKJ,IAFL,uBAEKA,IAFL,mBAGH,MAAMzB,CAAAA,GAAG,CAACc,aAAa,CAAC,CAAEW,IAAI,CAAJA,IAAF,CAAQP,cAAc,CAAE,CAAEc,WAAW,CAAXA,WAAF,CAAxB,CAAD,CAAd,CAAT,CAHG,mHAKH,MAAMhC,CAAAA,GAAG,CAACa,aAAa,eAAd,CAAT,CALG,yEASP,MAAO,SAAUlB,CAAAA,iBAAV,kMAA8BgC,OAA9B,CAAyCF,IAAzC,eAAyCA,IAAzC,CAA+CP,cAA/C,eAA+CA,cAA/C,mBACL,MAAM7B,CAAAA,uBAAuB,CAACoC,IAAD,CAAOP,cAAP,CAA7B,CADK,0DAIP,MAAO,SAAUtB,CAAAA,eAAV,mJACL,MAAMG,CAAAA,UAAU,CAACK,eAAe,CAAC8B,eAAjB,CAAkCvC,iBAAlC,CAAhB,CADK,0DAIP,MAAO,SAAUE,CAAAA,aAAV,iJACL,MAAME,CAAAA,UAAU,CAACK,eAAe,CAAC+B,aAAjB,CAAgCzC,MAAhC,CAAhB,CADK,0DAIP,MAAO,SAAUI,CAAAA,SAAV,6IACL,MAAMI,CAAAA,GAAG,CAAC,CACRD,IAAI,CAACV,mBAAD,CADI,CAERU,IAAI,CAACR,kBAAD,CAFI,CAGRQ,IAAI,CAACb,kBAAD,CAHI,CAIRa,IAAI,CAACf,cAAD,CAJI,CAKRe,IAAI,CAACL,eAAD,CALI,CAMRK,IAAI,CAACJ,aAAD,CANI,CAAD,CAAT,CADK","sourcesContent":["import { takeLatest, put, call, all, take } from \"redux-saga/effects\";\r\nimport userActionTypes from \"./user.types\";\r\nimport {\r\n  auth,\r\n  googleProvider,\r\n  createUserProfileDocument,\r\n  getCurrentUser,\r\n} from \"../../firebase/firebase.utils\";\r\n\r\nimport {\r\n  signInFailure,\r\n  signInSuccess,\r\n  signOutSuccess,\r\n  signOutFailure,\r\n  signUpFailure,\r\n  signUpSuccess,\r\n} from \"./user.actions\";\r\n\r\nexport function* signOut() {\r\n  try {\r\n    yield auth.signOut();\r\n    yield put(signOutSuccess());\r\n  } catch (error) {\r\n    yield put(signOutFailure());\r\n  }\r\n}\r\n\r\nexport function* onSignOutStart() {\r\n  yield takeLatest(userActionTypes.SIGN_OUT_START, signOut);\r\n}\r\n\r\nexport function* isUserAuthenticated() {\r\n  try {\r\n    const userAuth = yield getCurrentUser();\r\n    if (!userAuth) return;\r\n    yield getSnapshotFromUserAuth(userAuth);\r\n  } catch (error) {\r\n    yield put(signInFailure(error));\r\n  }\r\n}\r\n\r\nexport function* onCheckUserSession() {\r\n  yield takeLatest(userActionTypes.CHECK_USER_SESSION, isUserAuthenticated);\r\n}\r\n\r\nexport function* getSnapshotFromUserAuth(userAuth, additionalData) {\r\n  try {\r\n    const userRef = yield call(\r\n      createUserProfileDocument,\r\n      userAuth,\r\n      additionalData\r\n    );\r\n    const userSnapshot = yield userRef.get();\r\n\r\n    yield put(signInSuccess({ id: userSnapshot.id, ...userSnapshot.data() }));\r\n  } catch (error) {\r\n    yield put(signInFailure(error));\r\n  }\r\n}\r\n\r\nexport function* signInWithGoogle() {\r\n  try {\r\n    const { user } = yield auth.signInWithPopup(googleProvider);\r\n    yield getSnapshotFromUserAuth(user);\r\n  } catch (error) {\r\n    yield put(signInFailure(error));\r\n  }\r\n}\r\n\r\nexport function* onGoogleSignInStart() {\r\n  yield takeLatest(userActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\r\n}\r\n\r\nexport function* signInWithEmail({ payload: { email, password } }) {\r\n  try {\r\n    const { user } = yield auth.signInWithEmailAndPassword(email, password);\r\n    yield getSnapshotFromUserAuth(user);\r\n  } catch (error) {\r\n    yield put(signInFailure(error));\r\n  }\r\n}\r\n\r\nexport function* onEmailSignInStart() {\r\n  yield takeLatest(userActionTypes.EMAIL_SIGN_IN_START, signInWithEmail);\r\n}\r\n\r\nexport function* signUp({ payload: { email, password, displayName } }) {\r\n  try {\r\n    const { user } = yield auth.createUserWithEmailAndPassword(email, password);\r\n    yield put(signUpSuccess({ user, additionalData: { displayName } }));\r\n  } catch (error) {\r\n    yield put(signUpFailure(error));\r\n  }\r\n}\r\n\r\nexport function* signInAfterSignUp({ payload: { user, additionalData } }) {\r\n  yield getSnapshotFromUserAuth(user, additionalData);\r\n}\r\n\r\nexport function* onSignUpSuccess() {\r\n  yield takeLatest(userActionTypes.SIGN_UP_SUCCESS, signInAfterSignUp);\r\n}\r\n\r\nexport function* onSignUpStart() {\r\n  yield takeLatest(userActionTypes.SIGN_UP_START, signUp);\r\n}\r\n\r\nexport function* userSagas() {\r\n  yield all([\r\n    call(onGoogleSignInStart),\r\n    call(onEmailSignInStart),\r\n    call(onCheckUserSession),\r\n    call(onSignOutStart),\r\n    call(onSignUpSuccess),\r\n    call(onSignUpStart),\r\n  ]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}